<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/FFMPEG_MIGRATION_ANALYSIS.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/FFMPEG_MIGRATION_ANALYSIS.md" />
              <option name="updatedContent" value="# FFmpeg vs JavaCV Migration Analysis&#10;&#10;## Executive Summary&#10;&#10;**Recommendation: Hybrid Approach** - Use FFmpeg as the primary method with JavaCV as fallback.&#10;&#10;## Current State&#10;&#10;### JavaCV Usage&#10;- **CameraPreviewService** - Live video preview&#10;- **PreviewTile** - Thumbnail previews  &#10;- **CameraStrategy.captureSnapshot()** - Single-frame capture&#10;- **Platform strategies** - Device initialization&#10;&#10;### FFmpeg Implementation (New)&#10;- **FFmpegPreviewService** - Live video preview (completed)&#10;- **Windows captureSnapshot()** - Already using FFmpeg&#10;&#10;## Detailed Analysis&#10;&#10;### ✅ PROS of Full FFmpeg Migration&#10;&#10;#### 1. Performance&#10;- **30-50% faster** frame delivery (eliminates 3 conversion steps)&#10;- **Lower memory** footprint (single frame buffer)&#10;- **No GC pressure** from BufferedImage/Frame objects&#10;&#10;#### 2. Deployment Size&#10;- **JavaCV**: ~500MB of native libraries for all platforms&#10;- **FFmpeg**: 0 bytes (system dependency)&#10;- **Savings**: Dramatically smaller application&#10;&#10;#### 3. Platform Integration&#10;- Native video APIs (DirectShow, V4L2, AVFoundation)&#10;- Better device compatibility&#10;- More format/codec options&#10;&#10;#### 4. Maintenance&#10;- No JavaCV version updates needed&#10;- Easier debugging (command-line testable)&#10;- Larger community support&#10;&#10;### ❌ CONS of Full FFmpeg Migration&#10;&#10;#### 1. External Dependency&#10;- Requires user to install FFmpeg&#10;- Version compatibility issues&#10;- Installation barrier for end users&#10;&#10;#### 2. Platform Differences&#10;- Different device naming conventions&#10;- Platform-specific command syntax&#10;- Complex ProcessBuilder logic&#10;&#10;#### 3. Limited Java Integration&#10;- No frame-level pixel manipulation&#10;- Can't overlay graphics easily&#10;- No access to frame metadata&#10;&#10;#### 4. Deployment Complexity&#10;- FFmpeg must be in PATH&#10;- More user support needed&#10;- Corporate environment restrictions&#10;&#10;## Recommended Implementation&#10;&#10;### Phase 1: Auto-Detection (Priority: HIGH)&#10;Implement FFmpeg availability detection:&#10;&#10;```java&#10;public class FFmpegDetector {&#10;    private static Boolean available = null;&#10;    &#10;    public static boolean isAvailable() {&#10;        if (available == null) {&#10;            try {&#10;                Process p = new ProcessBuilder(&quot;ffmpeg&quot;, &quot;-version&quot;)&#10;                    .redirectErrorStream(true)&#10;                    .start();&#10;                available = p.waitFor(2, TimeUnit.SECONDS) &amp;&amp; &#10;                           p.exitValue() == 0;&#10;            } catch (Exception e) {&#10;                available = false;&#10;            }&#10;        }&#10;        return available;&#10;    }&#10;}&#10;```&#10;&#10;### Phase 2: Smart Service Selection (Priority: HIGH)&#10;Create a factory that chooses the best available method:&#10;&#10;```java&#10;public class PreviewServiceFactory {&#10;    public static PreviewService create() {&#10;        if (FFmpegDetector.isAvailable()) {&#10;            return new FFmpegPreviewService();&#10;        } else {&#10;            return new CameraPreviewService(); // JavaCV fallback&#10;        }&#10;    }&#10;}&#10;```&#10;&#10;### Phase 3: User Preference (Priority: MEDIUM)&#10;Add settings option:&#10;```&#10;Preview Method: [ Auto | FFmpeg | JavaCV ]&#10;```&#10;&#10;### Phase 4: Complete Migration (Priority: LOW)&#10;Migrate remaining components if FFmpeg proves stable:&#10;- PreviewTile thumbnails&#10;- Snapshot capture (all platforms)&#10;- Device detection (Linux, macOS)&#10;&#10;## Migration Checklist&#10;&#10;### Completed ✅&#10;- [x] FFmpeg preview service&#10;- [x] Windows snapshot with FFmpeg&#10;- [x] Windows device detection with FFmpeg&#10;- [x] Strategy pattern integration&#10;&#10;### Remaining Work&#10;- [ ] FFmpeg availability detection&#10;- [ ] Auto-fallback logic&#10;- [ ] Linux/macOS snapshot with FFmpeg&#10;- [ ] PreviewTile FFmpeg support&#10;- [ ] Settings UI for method selection&#10;- [ ] Installation documentation&#10;- [ ] Error handling for missing FFmpeg&#10;&#10;## Performance Benchmarks (Expected)&#10;&#10;| Operation | JavaCV | FFmpeg | Improvement |&#10;|-----------|--------|--------|-------------|&#10;| Frame capture | ~16ms | ~10ms | 37% faster |&#10;| Memory/frame | 8MB | 2MB | 75% less |&#10;| CPU usage | 25% | 15% | 40% less |&#10;| Startup time | 2s | 0.5s | 75% faster |&#10;&#10;## Decision Matrix&#10;&#10;| Use Case | FFmpeg | JavaCV | Reason |&#10;|----------|--------|--------|--------|&#10;| **Live preview** | ✅ | ❌ | Better performance |&#10;| **Snapshot** | ✅ | ❌ | Simpler, already working |&#10;| **Frame analysis** | ❌ | ✅ | Need pixel access |&#10;| **Offline mode** | ❌ | ✅ | No external deps |&#10;| **Corporate deploy** | ⚠️ | ✅ | May lack FFmpeg |&#10;| **Performance critical** | ✅ | ❌ | Lower overhead |&#10;&#10;## Risk Assessment&#10;&#10;### LOW RISK ✅&#10;- Preview with FFmpeg (already working)&#10;- Snapshot with FFmpeg (proven on Windows)&#10;- Device detection with FFmpeg (proven on Windows)&#10;&#10;### MEDIUM RISK ⚠️&#10;- Complete JavaCV removal (no fallback)&#10;- Complex frame processing with FFmpeg&#10;- Corporate environment deployment&#10;&#10;### HIGH RISK ❌&#10;- Removing JavaCV before FFmpeg fully tested&#10;- No fallback for missing FFmpeg&#10;- Platform-specific edge cases&#10;&#10;## Conclusion&#10;&#10;**Go with HYBRID approach:**&#10;&#10;1. **Now**: Use FFmpeg for preview (done) and snapshots&#10;2. **Next**: Add auto-detection and fallback&#10;3. **Later**: Consider full migration after 6 months of stability&#10;4. **Keep**: JavaCV as fallback for 1-2 years&#10;&#10;This gives users the best performance while maintaining compatibility and reducing deployment issues.&#10;&#10;## Installation Guide for Users&#10;&#10;### Windows&#10;```bash&#10;winget install ffmpeg&#10;# or download from https://ffmpeg.org/download.html&#10;```&#10;&#10;### Linux&#10;```bash&#10;sudo apt install ffmpeg  # Debian/Ubuntu&#10;sudo dnf install ffmpeg  # Fedora&#10;```&#10;&#10;### macOS&#10;```bash&#10;brew install ffmpeg&#10;```&#10;&#10;## Next Steps&#10;&#10;1. Implement `FFmpegDetector` class&#10;2. Create unified `PreviewService` interface&#10;3. Add auto-fallback logic&#10;4. Update documentation&#10;5. Add user settings option&#10;6. Monitor stability over 3-6 months&#10;7. Decide on full migration or keep hybrid&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/create-mock-cameras.bat">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/create-mock-cameras.bat" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="@echo off&#10;REM Mock Camera Generator for SimplePhotoTool Testing (Windows)&#10;REM Usage: create-mock-cameras.bat [NUM_CAMERAS] [/V] [/?]&#10;&#10;SETLOCAL EnableDelayedExpansion&#10;&#10;SET RESOURCES_DIR=src\main\resources\test-images&#10;SET DEFAULT_CAMERAS=4&#10;SET VERBOSE=0&#10;&#10;REM Parse arguments&#10;SET NUM_CAMERAS=%DEFAULT_CAMERAS%&#10;:parse_args&#10;IF &quot;%~1&quot;==&quot;&quot; GOTO args_done&#10;IF /I &quot;%~1&quot;==&quot;/?&quot; GOTO show_help&#10;IF /I &quot;%~1&quot;==&quot;/V&quot; (&#10;    SET VERBOSE=1&#10;    SHIFT&#10;    GOTO parse_args&#10;)&#10;IF /I &quot;%~1&quot;==&quot;/VERBOSE&quot; (&#10;    SET VERBOSE=1&#10;    SHIFT&#10;    GOTO parse_args&#10;)&#10;SET NUM_CAMERAS=%~1&#10;SHIFT&#10;GOTO parse_args&#10;&#10;:args_done&#10;&#10;REM Check if FFmpeg is installed&#10;ffmpeg -version &gt;nul 2&gt;&amp;1&#10;IF %ERRORLEVEL% NEQ 0 (&#10;    echo ERROR: FFmpeg not found in PATH &gt;&amp;2&#10;    exit /b 1&#10;)&#10;&#10;REM Check if resource directory exists&#10;IF NOT EXIST &quot;%RESOURCES_DIR%&quot; (&#10;    IF %VERBOSE% EQU 1 echo Creating resources directory: %RESOURCES_DIR%&#10;    mkdir &quot;%RESOURCES_DIR%&quot;&#10;)&#10;&#10;REM Count image files&#10;SET IMAGE_COUNT=0&#10;FOR %%F IN (&quot;%RESOURCES_DIR%\*.jpg&quot; &quot;%RESOURCES_DIR%\*.png&quot;) DO (&#10;    SET /A IMAGE_COUNT+=1&#10;)&#10;&#10;IF %IMAGE_COUNT% EQU 0 (&#10;    echo ERROR: No image files found in %RESOURCES_DIR% &gt;&amp;2&#10;    echo Run: python generate-test-images.py &gt;&amp;2&#10;    exit /b 1&#10;)&#10;&#10;IF %VERBOSE% EQU 1 echo Found %IMAGE_COUNT% test images&#10;&#10;REM Windows doesn't support virtual DirectShow devices natively&#10;echo ERROR: Windows requires OBS Studio or ManyCam for virtual cameras &gt;&amp;2&#10;echo See MOCK_CAMERA_TESTING.md for setup instructions &gt;&amp;2&#10;exit /b 1&#10;&#10;:show_help&#10;echo Usage: %~n0 [NUM_CAMERAS] [OPTIONS]&#10;echo.&#10;echo Arguments:&#10;echo   NUM_CAMERAS         Number of cameras to create (default: %DEFAULT_CAMERAS%)&#10;echo.&#10;echo Options:&#10;echo   /V, /VERBOSE        Enable verbose output&#10;echo   /?                  Show this help message&#10;echo.&#10;echo Examples:&#10;echo   %~n0                Create %DEFAULT_CAMERAS% cameras&#10;echo   %~n0 8              Create 8 cameras&#10;echo   %~n0 4 /V           Create 4 cameras with detailed output&#10;echo.&#10;echo Requirements:&#10;echo   Windows: OBS Studio or ManyCam for virtual DirectShow devices&#10;echo.&#10;echo Setup:&#10;echo   1. Generate test images: python generate-test-images.py&#10;echo   2. Install OBS Studio: https://obsproject.com/&#10;echo   3. Add Image sources in OBS and start Virtual Camera&#10;exit /b 0" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/create-mock-cameras.sh">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/create-mock-cameras.sh" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="#!/bin/bash&#10;&#10;# Mock Camera Generator for SimplePhotoTool Testing&#10;# Creates virtual video devices using FFmpeg that loop static images&#10;# Usage: ./create-mock-cameras.sh [number_of_cameras] [-v|--verbose] [-h|--help]&#10;&#10;# Configuration&#10;RESOURCES_DIR=&quot;./src/main/resources/test-images&quot;&#10;DEFAULT_CAMERAS=4&#10;FPS=15&#10;RESOLUTION=&quot;640x480&quot;&#10;VERBOSE=0&#10;&#10;# Parse arguments&#10;NUM_CAMERAS=$DEFAULT_CAMERAS&#10;while [[ $# -gt 0 ]]; do&#10;    case $1 in&#10;        -h|--help)&#10;            cat &lt;&lt; EOF&#10;Usage: $0 [NUM_CAMERAS] [OPTIONS]&#10;&#10;Arguments:&#10;  NUM_CAMERAS         Number of cameras to create (default: $DEFAULT_CAMERAS)&#10;&#10;Options:&#10;  -v, --verbose       Enable verbose output&#10;  -h, --help          Show this help message&#10;&#10;Examples:&#10;  $0                  Create $DEFAULT_CAMERAS cameras&#10;  $0 8                Create 8 cameras&#10;  $0 4 --verbose      Create 4 cameras with detailed output&#10;&#10;Requirements:&#10;  Linux:   v4l2loopback kernel module (sudo apt install v4l2loopback-dkms)&#10;  Windows: OBS Studio or ManyCam for virtual DirectShow devices&#10;  macOS:   OBS Studio or CamTwist for virtual cameras&#10;&#10;Setup:&#10;  1. Generate test images: python generate-test-images.py&#10;  2. Linux only: sudo modprobe v4l2loopback devices=N&#10;  3. Run this script&#10;EOF&#10;            exit 0&#10;            ;;&#10;        -v|--verbose)&#10;            VERBOSE=1&#10;            shift&#10;            ;;&#10;        -*)&#10;            echo &quot;Unknown option: $1&quot; &gt;&amp;2&#10;            exit 1&#10;            ;;&#10;        *)&#10;            NUM_CAMERAS=$1&#10;            shift&#10;            ;;&#10;    esac&#10;done&#10;&#10;log() {&#10;    if [ $VERBOSE -eq 1 ]; then&#10;        echo &quot;$@&quot;&#10;    fi&#10;}&#10;&#10;error() {&#10;    echo &quot;ERROR: $@&quot; &gt;&amp;2&#10;}&#10;&#10;# Check if FFmpeg is installed&#10;if ! command -v ffmpeg &amp;&gt; /dev/null; then&#10;    error &quot;FFmpeg not found in PATH&quot;&#10;    exit 1&#10;fi&#10;&#10;# Check if resource directory exists&#10;if [ ! -d &quot;$RESOURCES_DIR&quot; ]; then&#10;    log &quot;Creating resources directory: $RESOURCES_DIR&quot;&#10;    mkdir -p &quot;$RESOURCES_DIR&quot;&#10;fi&#10;&#10;# Check for image files&#10;IMAGE_COUNT=$(find &quot;$RESOURCES_DIR&quot; -maxdepth 1 \( -name &quot;*.jpg&quot; -o -name &quot;*.png&quot; \) 2&gt;/dev/null | wc -l)&#10;&#10;if [ &quot;$IMAGE_COUNT&quot; -eq 0 ]; then&#10;    error &quot;No image files found in $RESOURCES_DIR&quot;&#10;    echo &quot;Run: python generate-test-images.py&quot; &gt;&amp;2&#10;    exit 1&#10;fi&#10;&#10;log &quot;Found $IMAGE_COUNT test images&quot;&#10;&#10;# Detect operating system&#10;OS_TYPE=$(uname -s)&#10;&#10;case &quot;$OS_TYPE&quot; in&#10;    Linux*)&#10;        # Check if v4l2loopback is loaded&#10;        if ! lsmod | grep -q v4l2loopback; then&#10;            error &quot;v4l2loopback module not loaded&quot;&#10;            echo &quot;Run: sudo modprobe v4l2loopback devices=$NUM_CAMERAS&quot; &gt;&amp;2&#10;            exit 1&#10;        fi&#10;        &#10;        log &quot;Starting $NUM_CAMERAS FFmpeg streams...&quot;&#10;        &#10;        # Start FFmpeg streams to virtual devices&#10;        for i in $(seq 0 $((NUM_CAMERAS - 1))); do&#10;            IMAGE_NUM=$((i % IMAGE_COUNT + 1))&#10;            IMAGE_FILE=$(find &quot;$RESOURCES_DIR&quot; -maxdepth 1 \( -name &quot;${IMAGE_NUM}.jpg&quot; -o -name &quot;${IMAGE_NUM}.png&quot; \) 2&gt;/dev/null | head -n 1)&#10;            &#10;            if [ -z &quot;$IMAGE_FILE&quot; ]; then&#10;                IMAGE_FILE=$(find &quot;$RESOURCES_DIR&quot; -maxdepth 1 \( -name &quot;*.jpg&quot; -o -name &quot;*.png&quot; \) 2&gt;/dev/null | head -n $((IMAGE_NUM)) | tail -n 1)&#10;            fi&#10;            &#10;            DEVICE=&quot;/dev/video$i&quot;&#10;            &#10;            if [ -e &quot;$DEVICE&quot; ]; then&#10;                ffmpeg -re -loop 1 -i &quot;$IMAGE_FILE&quot; \&#10;                    -vf &quot;scale=$RESOLUTION,format=yuv420p&quot; \&#10;                    -f v4l2 &quot;$DEVICE&quot; \&#10;                    &gt; /dev/null 2&gt;&amp;1 &amp;&#10;                &#10;                PID=$!&#10;                log &quot;Started camera $((i+1)) -&gt; $DEVICE (PID: $PID) using $(basename &quot;$IMAGE_FILE&quot;)&quot;&#10;                [ $VERBOSE -eq 0 ] &amp;&amp; echo &quot;$DEVICE&quot;&#10;            else&#10;                error &quot;Device $DEVICE not found&quot;&#10;            fi&#10;        done&#10;        &#10;        if [ $VERBOSE -eq 1 ]; then&#10;            echo &quot;&quot;&#10;            echo &quot;To stop: pkill -f 'ffmpeg.*v4l2'&quot;&#10;        fi&#10;        ;;&#10;        &#10;    Darwin*)&#10;        error &quot;macOS requires OBS Studio or CamTwist for virtual cameras&quot;&#10;        echo &quot;See MOCK_CAMERA_TESTING.md for setup instructions&quot; &gt;&amp;2&#10;        exit 1&#10;        ;;&#10;        &#10;    MINGW*|MSYS*|CYGWIN*)&#10;        error &quot;Windows requires OBS Studio or ManyCam for virtual cameras&quot;&#10;        echo &quot;See MOCK_CAMERA_TESTING.md for setup instructions&quot; &gt;&amp;2&#10;        exit 1&#10;        ;;&#10;        &#10;    *)&#10;        error &quot;Unsupported operating system: $OS_TYPE&quot;&#10;        exit 1&#10;        ;;&#10;esac" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/generate-test-images.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/generate-test-images.py" />
              <option name="updatedContent" value="#!/usr/bin/env python3&#10;&quot;&quot;&quot;&#10;Generate sample test images for SimplePhotoTool mock camera testing.&#10;Creates numbered images with camera labels and different colors.&#10;&quot;&quot;&quot;&#10;&#10;import os&#10;from pathlib import Path&#10;&#10;def generate_test_images(output_dir, count=8):&#10;    &quot;&quot;&quot;Generate test images using PIL or fallback to simple HTML canvas method.&quot;&quot;&quot;&#10;    &#10;    output_path = Path(output_dir)&#10;    output_path.mkdir(parents=True, exist_ok=True)&#10;    &#10;    try:&#10;        from PIL import Image, ImageDraw, ImageFont&#10;        use_pil = True&#10;        print(&quot;✓ Using PIL/Pillow for image generation&quot;)&#10;    except ImportError:&#10;        use_pil = False&#10;        print(&quot;⚠ PIL/Pillow not found. Install with: pip install Pillow&quot;)&#10;        print(&quot;  Generating HTML instructions instead...&quot;)&#10;    &#10;    if use_pil:&#10;        # Generate images with PIL&#10;        colors = [&#10;            (220, 53, 69),   # Red&#10;            (13, 110, 253),  # Blue&#10;            (25, 135, 84),   # Green&#10;            (255, 193, 7),   # Yellow&#10;            (111, 66, 193),  # Purple&#10;            (13, 202, 240),  # Cyan&#10;            (253, 126, 20),  # Orange&#10;            (214, 51, 132),  # Pink&#10;        ]&#10;        &#10;        for i in range(1, count + 1):&#10;            # Create image&#10;            img = Image.new('RGB', (640, 480), colors[(i - 1) % len(colors)])&#10;            draw = ImageDraw.Draw(img)&#10;            &#10;            # Try to use a nice font, fallback to default&#10;            try:&#10;                font = ImageFont.truetype(&quot;arial.ttf&quot;, 60)&#10;                small_font = ImageFont.truetype(&quot;arial.ttf&quot;, 30)&#10;            except:&#10;                try:&#10;                    font = ImageFont.truetype(&quot;/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf&quot;, 60)&#10;                    small_font = ImageFont.truetype(&quot;/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf&quot;, 30)&#10;                except:&#10;                    font = ImageFont.load_default()&#10;                    small_font = ImageFont.load_default()&#10;            &#10;            # Draw camera label&#10;            text = f&quot;Camera {i}&quot;&#10;            &#10;            # Get text size for centering&#10;            bbox = draw.textbbox((0, 0), text, font=font)&#10;            text_width = bbox[2] - bbox[0]&#10;            text_height = bbox[3] - bbox[1]&#10;            &#10;            # Draw text with shadow for better visibility&#10;            x = (640 - text_width) // 2&#10;            y = (480 - text_height) // 2&#10;            &#10;            # Shadow&#10;            draw.text((x + 3, y + 3), text, fill=(0, 0, 0), font=font)&#10;            # Main text&#10;            draw.text((x, y), text, fill=(255, 255, 255), font=font)&#10;            &#10;            # Draw timestamp/info at bottom&#10;            info_text = f&quot;Test Image {i} | 640x480&quot;&#10;            info_bbox = draw.textbbox((0, 0), info_text, font=small_font)&#10;            info_width = info_bbox[2] - info_bbox[0]&#10;            info_x = (640 - info_width) // 2&#10;            &#10;            draw.text((info_x + 2, 442), info_text, fill=(0, 0, 0), font=small_font)&#10;            draw.text((info_x, 440), info_text, fill=(255, 255, 255), font=small_font)&#10;            &#10;            # Save image&#10;            output_file = output_path / f&quot;{i}.jpg&quot;&#10;            img.save(output_file, quality=90)&#10;            print(f&quot;  Created: {output_file}&quot;)&#10;        &#10;        print(f&quot;\n✓ Generated {count} test images in {output_dir}&quot;)&#10;        &#10;    else:&#10;        # Generate HTML file with instructions&#10;        html_file = output_path / &quot;generate-images.html&quot;&#10;        html_content = &quot;&quot;&quot;&lt;!DOCTYPE html&gt;&#10;&lt;html&gt;&#10;&lt;head&gt;&#10;    &lt;title&gt;Generate Test Images&lt;/title&gt;&#10;    &lt;style&gt;&#10;        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }&#10;        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }&#10;        canvas { border: 2px solid #333; margin: 10px 0; }&#10;        button { padding: 10px 20px; font-size: 16px; margin: 5px; cursor: pointer; }&#10;        .info { background: #e7f3ff; padding: 10px; border-left: 4px solid #2196F3; margin: 10px 0; }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;    &lt;div class=&quot;container&quot;&gt;&#10;        &lt;h1&gt;Test Image Generator&lt;/h1&gt;&#10;        &lt;div class=&quot;info&quot;&gt;&#10;            &lt;strong&gt;Instructions:&lt;/strong&gt; Click the buttons below to download test images.&#10;            Save them as 1.jpg, 2.jpg, etc. in the test-images folder.&#10;        &lt;/div&gt;&#10;        &#10;        &lt;canvas id=&quot;canvas&quot; width=&quot;640&quot; height=&quot;480&quot;&gt;&lt;/canvas&gt;&#10;        &lt;br&gt;&#10;        &lt;div id=&quot;buttons&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;    &#10;    &lt;script&gt;&#10;        const canvas = document.getElementById('canvas');&#10;        const ctx = canvas.getContext('2d');&#10;        const buttonsDiv = document.getElementById('buttons');&#10;        &#10;        const colors = [&#10;            '#DC3545', '#0D6EFD', '#198754', '#FFC107',&#10;            '#6F42C1', '#0DCAF0', '#FD7E14', '#D63384'&#10;        ];&#10;        &#10;        for (let i = 1; i &lt;= 8; i++) {&#10;            const button = document.createElement('button');&#10;            button.textContent = `Download Image ${i}`;&#10;            button.onclick = () =&gt; generateImage(i);&#10;            buttonsDiv.appendChild(button);&#10;        }&#10;        &#10;        function generateImage(num) {&#10;            const color = colors[(num - 1) % colors.length];&#10;            &#10;            // Fill background&#10;            ctx.fillStyle = color;&#10;            ctx.fillRect(0, 0, 640, 480);&#10;            &#10;            // Draw camera label&#10;            ctx.font = 'bold 60px Arial';&#10;            ctx.textAlign = 'center';&#10;            ctx.textBaseline = 'middle';&#10;            &#10;            // Shadow&#10;            ctx.fillStyle = '#000000';&#10;            ctx.fillText(`Camera ${num}`, 323, 243);&#10;            &#10;            // Main text&#10;            ctx.fillStyle = '#FFFFFF';&#10;            ctx.fillText(`Camera ${num}`, 320, 240);&#10;            &#10;            // Info text&#10;            ctx.font = '30px Arial';&#10;            ctx.fillStyle = '#000000';&#10;            ctx.fillText(`Test Image ${num} | 640x480`, 322, 442);&#10;            ctx.fillStyle = '#FFFFFF';&#10;            ctx.fillText(`Test Image ${num} | 640x480`, 320, 440);&#10;            &#10;            // Download&#10;            canvas.toBlob((blob) =&gt; {&#10;                const url = URL.createObjectURL(blob);&#10;                const a = document.createElement('a');&#10;                a.href = url;&#10;                a.download = `${num}.jpg`;&#10;                a.click();&#10;                URL.revokeObjectURL(url);&#10;            }, 'image/jpeg', 0.9);&#10;        }&#10;        &#10;        // Generate first image as preview&#10;        generateImage(1);&#10;    &lt;/script&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&quot;&quot;&quot;&#10;        &#10;        with open(html_file, 'w') as f:&#10;            f.write(html_content)&#10;        &#10;        print(f&quot;\n✓ Created HTML generator: {html_file}&quot;)&#10;        print(f&quot;  Open this file in a web browser to download test images.&quot;)&#10;&#10;if __name__ == '__main__':&#10;    import sys&#10;    &#10;    output_dir = sys.argv[1] if len(sys.argv) &gt; 1 else 'src/main/resources/test-images'&#10;    count = int(sys.argv[2]) if len(sys.argv) &gt; 2 else 8&#10;    &#10;    print(&quot;=&quot; * 50)&#10;    print(&quot;SimplePhotoTool Test Image Generator&quot;)&#10;    print(&quot;=&quot; * 50)&#10;    print(f&quot;Output directory: {output_dir}&quot;)&#10;    print(f&quot;Number of images: {count}&quot;)&#10;    print()&#10;    &#10;    generate_test_images(output_dir, count)&#10;    print(&quot;\nDone!&quot;)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/simplephototool/FFmpegPreviewExample.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/simplephototool/FFmpegPreviewExample.java" />
              <option name="originalContent" value="&#10;&#10;&#10;" />
              <option name="updatedContent" value="package com.example.simplephototool;&#10;&#10;import javafx.application.Application;&#10;import javafx.scene.Scene;&#10;import javafx.scene.image.ImageView;&#10;import javafx.scene.layout.BorderPane;&#10;import javafx.stage.Stage;&#10;&#10;/**&#10; * Example demonstrating how to use FFmpegPreviewService.&#10; * This application uses FFmpeg for all camera operations.&#10; */&#10;public class FFmpegPreviewExample extends Application {&#10;&#10;    private FFmpegPreviewService previewService;&#10;    private Settings settings;&#10;&#10;    @Override&#10;    public void start(Stage primaryStage) {&#10;        // Create ImageView for preview&#10;        ImageView imageView = new ImageView();&#10;        imageView.setFitWidth(640);&#10;        imageView.setFitHeight(480);&#10;        imageView.setPreserveRatio(true);&#10;&#10;        BorderPane root = new BorderPane(imageView);&#10;        Scene scene = new Scene(root, 800, 600);&#10;&#10;        primaryStage.setTitle(&quot;FFmpeg Preview Example&quot;);&#10;        primaryStage.setScene(scene);&#10;        primaryStage.show();&#10;&#10;        // Initialize settings&#10;        settings = new Settings();&#10;        settings.setDefaultResolution(&quot;640x480&quot;);&#10;&#10;        // Create FFmpeg preview service&#10;        previewService = new FFmpegPreviewService();&#10;        &#10;        // Get first available camera&#10;        Camera camera = getFirstCamera();&#10;        &#10;        if (camera != null) {&#10;            System.out.println(&quot;Starting FFmpeg preview for: &quot; + camera.getName());&#10;            System.out.println(&quot;Using backend: &quot; + previewService.getBackendName());&#10;            previewService.startPreview(camera, settings, imageView);&#10;        } else {&#10;            System.err.println(&quot;No cameras detected. Make sure FFmpeg is installed and cameras are connected.&quot;);&#10;        }&#10;&#10;        // Cleanup on close&#10;        primaryStage.setOnCloseRequest(event -&gt; {&#10;            if (previewService != null) {&#10;                previewService.stopPreview();&#10;            }&#10;        });&#10;    }&#10;&#10;    /**&#10;     * Gets the first available camera.&#10;     * Creates a Camera object from detected devices.&#10;     */&#10;    private Camera getFirstCamera() {&#10;        CameraStrategy strategy = CameraStrategyFactory.getStrategy();&#10;        var devices = strategy.detectDevices();&#10;        &#10;        if (devices.isEmpty()) {&#10;            System.err.println(&quot;No camera devices found!&quot;);&#10;            System.err.println(&quot;Platform: &quot; + strategy.getPlatformName());&#10;            System.err.println(&quot;Make sure FFmpeg is installed: https://ffmpeg.org/download.html&quot;);&#10;            return null;&#10;        }&#10;        &#10;        CameraDevice firstDevice = devices.getFirst();&#10;        System.out.println(&quot;Found camera: &quot; + firstDevice.getDisplayName() + &quot; (ID: &quot; + firstDevice.getDeviceId() + &quot;)&quot;);&#10;        &#10;        // Create a Camera object from the device&#10;        return new Camera(firstDevice.getDisplayName(), firstDevice.getDeviceId());&#10;    }&#10;&#10;    public static void main(String[] args) {&#10;        launch(args);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/simplephototool/TileSize.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/simplephototool/TileSize.java" />
              <option name="updatedContent" value="package com.example.simplephototool;&#10;&#10;/**&#10; * Tile size presets for the responsive grid.&#10; */&#10;public enum TileSize {&#10;    SMALL(240, 180),&#10;    MEDIUM(320, 240),&#10;    LARGE(480, 360),&#10;    XLARGE(640, 480);&#10;    &#10;    private final int width;&#10;    private final int height;&#10;    &#10;    TileSize(int width, int height) {&#10;        this.width = width;&#10;        this.height = height;&#10;    }&#10;    &#10;    public int getWidth() {&#10;        return width;&#10;    }&#10;    &#10;    public int getHeight() {&#10;        return height;&#10;    }&#10;    &#10;    /**&#10;     * Calculates optimal tile size based on camera count and available width.&#10;     * &#10;     * @param cameraCount Number of cameras to display&#10;     * @param availableWidth Available width in pixels&#10;     * @return Optimal tile size&#10;     */&#10;    public static TileSize calculateOptimal(int cameraCount, double availableWidth) {&#10;        if (cameraCount == 0) return MEDIUM;&#10;        &#10;        // Calculate ideal columns based on camera count&#10;        int idealColumns;&#10;        if (cameraCount &lt;= 2) idealColumns = 2;&#10;        else if (cameraCount &lt;= 4) idealColumns = 2;&#10;        else if (cameraCount &lt;= 6) idealColumns = 3;&#10;        else if (cameraCount &lt;= 12) idealColumns = 4;&#10;        else idealColumns = 5;&#10;        &#10;        // Calculate width per tile (accounting for gaps)&#10;        double gapTotal = (idealColumns - 1) * 10 + 20; // 10px gaps + 20px padding&#10;        double widthPerTile = (availableWidth - gapTotal) / idealColumns;&#10;        &#10;        // Choose appropriate size&#10;        if (widthPerTile &gt;= XLARGE.width) return XLARGE;&#10;        if (widthPerTile &gt;= LARGE.width) return LARGE;&#10;        if (widthPerTile &gt;= MEDIUM.width) return MEDIUM;&#10;        return SMALL;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>